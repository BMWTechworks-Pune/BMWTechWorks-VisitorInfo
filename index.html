â€‹
<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="utf-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1" />
Â  <title>BMWTechWorks India â€“ DPUNE</title>
Â  <style>
Â  Â  :root{--blue:#1c6ecf;--dark:#0b1f3d;--light:#f7f9fc;--border:#e3e8ef}
Â  Â  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,"Noto Sans",sans-serif;background:var(--light);color:#14202a}
Â  Â  header{background:#fff;border-bottom:1px solid var(--border);position:sticky;top:0;z-index:10}
Â  Â  .top{max-width:1080px;margin:0 auto;padding:10px 16px;display:flex;align-items:center;justify-content:space-between}
Â  Â  nav{max-width:1080px;margin:0 auto;padding:8px 16px;display:flex;flex-wrap:wrap;gap:8px}
Â  Â  button.nav{border:1px solid var(--border);background:#fff;color:#0b2540;padding:8px 12px;border-radius:10px;cursor:pointer;font-weight:600}
Â  Â  button.nav.active{border-color:var(--blue);background:#eaf3ff}
Â  Â  main{max-width:1080px;margin:16px auto;padding:0 16px 40px}
Â  Â  section.panel{display:none;background:#fff;border:1px solid var(--border);border-radius:12px;padding:16px}
Â  Â  section.panel.active{display:block}
Â  Â  h2{margin:0 0 8px;color:var(--dark)}
Â  Â  h3{margin:16px 0 8px;color:#0b2540}
Â  Â  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
Â  Â  .card{border:1px solid var(--border);border-radius:12px;padding:12px;background:#fafcff}
Â  Â  ul{margin:8px 0 0 18px}
Â  Â  table{width:100%;border-collapse:collapse;margin-top:8px}
Â  Â  th, td{border:1px solid #e3e8ef;padding:8px;text-align:left}
Â  Â  .footer-note{font-size:13px;color:#5a6b7a;margin-top:8px}
Â  Â  .qr{display:inline-block;padding:8px 12px;border:1px dashed #c9d6e5;border-radius:12px;background:#fff}
Â  Â  img.inset{max-width:100%;border:1px solid #d7dde8;border-radius:10px;margin:8px 0}
Â  Â  footer{padding:24px 16px 40px;text-align:center;color:#5a6b7a}
Â  Â  a.tel{white-space:nowrap}

Â  Â  /* Basic look & feel */
Â  Â  .card { padding: 12px; border: 1px solid #ddd; border-radius: 8px; background: #fff; }
Â  Â  .muted { color: #555; }
Â  Â  .controls-bar { display: flex; flex-direction: column; gap: 8px; }
Â  Â  .zoom-controls button, .select-controls button, .audio-controls button {
Â  Â  Â  padding: 6px 10px; border-radius: 6px; border: 1px solid #ccc; background: #f7f7f7; cursor: pointer;
Â  Â  }
Â  Â  .select-controls select { padding: 4px; }
Â  Â  .steps-wrap { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 12px; }
Â  Â  .steps-column ol { min-height: 80px; }

Â  Â Â 
/* Buttons inside share panel */
.btn {
Â  display: inline-block;
Â  padding: 8px 12px;
Â  border: 1px solid var(--border);
Â  border-radius: 10px;
Â  background: #fff;
Â  color: #0b2540;
Â  font-weight: 600;
Â  text-decoration: none;
Â  cursor: pointer;
}
.btn:hover { background: #eaf3ff; border-color: var(--blue); }

/* Ensure QR container looks tidy */
.qr img { border-radius: 8px; }

Â  Â Â 
Â  Â  /* Stage: pan/zoom container */
Â  Â  #imgStageWrapper {
Â  Â  Â  width: 100%;
Â  Â  Â  height: 58vh; /* adjust as needed */
Â  Â  Â  border: 1px solid #e0e0e0;
Â  Â  Â  border-radius: 10px;
Â  Â  Â  overflow: hidden;
Â  Â  Â  background: #fafafa;
Â  Â  Â  position: relative;
Â  Â  Â  margin-top: 10px;
Â  Â  }
Â  Â  #imgStage {
Â  Â  Â  width: 100%;
Â  Â  Â  height: 100%;
Â  Â  Â  transform-origin: 0 0;
Â  Â  Â  cursor: grab;
Â  Â  Â  position: relative;
Â  Â  }
Â  Â  #imgStage.grabbing { cursor: grabbing; }
Â  Â  #floorImg {
Â  Â  Â  position: absolute;
Â  Â  Â  left: 0; top: 0;
Â  Â  Â  user-select: none;
Â  Â  Â  -webkit-user-drag: none;
Â  Â  }
Â  Â  #routeCanvas {
Â  Â  Â  position: absolute;
Â  Â  Â  left: 0; top: 0; pointer-events: none;
Â  Â  }

Â  Â  /* Room markers */
Â  Â  .room-marker {
Â  Â  Â  position: absolute;
Â  Â  Â  transform: translate(-50%, -50%);
Â  Â  Â  background: rgba(255, 255, 255, 0.9);
Â  Â  Â  color: #333;
Â  Â  Â  border: 1px solid #b0b0b0;
Â  Â  Â  border-radius: 6px;
Â  Â  Â  padding: 3px 6px;
Â  Â  Â  font-size: 12px;
Â  Â  Â  white-space: nowrap;
Â  Â  Â  user-select: none;
Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  .room-marker:hover { background: #fff; }
Â  Â  .room-marker.selected-from { border-color: #0078d4; box-shadow: 0 0 0 2px rgba(0,120,212,0.2); }
Â  Â  .room-marker.selected-to Â  { border-color: #47a447; box-shadow: 0 0 0 2px rgba(71,164,71,0.2); }

Â  Â  /* --- Added: BMW-style header brand + light-grey language buttons --- */
Â  Â  .brand { display: inline-flex; align-items: center; gap: 12px; min-width: 0; }
Â  Â  .brand-logo { width: 40px; height: 40px; object-fit: contain; }
Â  Â  .brand-title {
Â  Â  Â  font-family: "BMW Type Next", "Helvetica Neue", Helvetica, Arial, system-ui, -apple-system, "Segoe UI",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â "Noto Sans", "Liberation Sans", sans-serif;
Â  Â  Â  font-weight: 700;
Â  Â  Â  font-size: 1.1rem;
Â  Â  Â  letter-spacing: 0.2px;
Â  Â  Â  color: #000;
Â  Â  Â  white-space: nowrap;
Â  Â  }
Â  Â  .lang-switch { display: inline-flex; align-items: center; gap: 8px; }
Â  Â  .lang-btn {
Â  Â  Â  appearance: none;
Â  Â  Â  border: 1px solid #d0d0d0;
Â  Â  Â  background: #f2f2f2; /* light grey */
Â  Â  Â  color: #1a1a1a;
Â  Â  Â  padding: 6px 10px;
Â  Â  Â  border-radius: 6px;
Â  Â  Â  font-family: inherit;
Â  Â  Â  font-size: 0.9rem;
Â  Â  Â  cursor: pointer;
Â  Â  Â  transition: background 0.15s ease, border-color 0.15s ease;
Â  Â  }
Â  Â  .lang-btn:hover { background: #e8e8e8; border-color: #c4c4c4; }
Â  Â  .lang-btn[aria-pressed="true"] {
Â  Â  Â  background: #e0e0e0;
Â  Â  Â  border-color: #bdbdbd;
Â  Â  Â  font-weight: 600;
Â  Â  }

Â  Â  @media (max-width: 480px) {
Â  Â  Â  .brand-title { font-size: 1rem; white-space: normal; }
Â  Â  Â  .brand-logo { width: 32px; height: 32px; }
Â  Â  }
Â  </style>
</head>
<body>


<header>
Â  <!-- Header with BMW logo and language buttons (updated: no table) -->
Â  <div class="top">
Â  Â  <div class="brand">
Â  Â  Â  <img
Â  Â  Â  Â  src="https://raw.githubusercontent.com/BMWTechworks-Pune/BMWTechWorks-VisitorInfo/main/BMW.jpeg"
Â  Â  Â  Â  alt="BMW logo"
Â  Â  Â  Â  class="brand-logo"
Â  Â  Â  Â  decoding="async"
Â  Â  Â  Â  loading="lazy"
Â  Â  Â age selection">
Â  Â  Â  BMWTechWorks India â€“ PuneDDD
Â  Â  Â  <button class="lang-btn" type="button" aria-pressed="true" data-lang="en">EN</button>
Â  Â  Â  <button class="lang-btn" type="button" aria-pressed="false" data-lang="de">DE</button>
Â  Â  </div>
Â  </div>

Â  <!-- Navigation buttons -->
Â  <nav>
Â  Â  <button class="nav active" data-panel="info">â„¹ï¸ BMWTechWorks Info</button>
Â  Â  <button class="nav" data-panel="sos">ğŸš¨ SOS â€“ Emergency</button>
Â  Â  <button class="nav" data-panel="assist">ğŸ†˜ Need Assistance</button>
Â  Â  <button class="nav" data-panel="layout">ğŸ—ºï¸ Floor Layout &amp; Exit</button>
Â  Â  <button class="nav" data-panel="ert">ğŸ›¡ï¸ ERT Members</button>
Â  Â  <button class="nav" data-panel="firstaid">ğŸ§‘â€âš•ï¸ First Aid &amp; Medical Support</button>
Â  Â  <button class="nav" data-panel="assembly">ğŸ“ Assembly Points</button>
Â  Â  <button class="nav" data-panel="rooms">ğŸ¢ Meeting Rooms</button>
Â  Â  <button class="nav" data-panel="it">ğŸ–¥ï¸ IT Helpdesk</button>
Â  Â  <button class="nav" data-panel="translate">ğŸŒ German â†” English</button>
Â  Â  <button class="nav" data-panel="parking">ğŸ…¿ï¸ Parking Info</button>
Â  Â  <button class="nav" data-panel="cab">ğŸš• Cab Facility</button>
Â  Â  <button class="nav" data-panel="food">ğŸ” Food Delivery Apps</button>
Â  Â  <button class="nav" data-panel="social">ğŸ”— Social Media Connect</button>
Â  Â  <button class="nav" data-panel="travel">ğŸ§­ Travel Info, Converter & Hotels</button>
Â  Â  <button class="nav" data-panel="hotels"> ğŸ¨ Hotels</button>
Â  Â  <button class="nav" data-panel="share">ğŸ“¥ Download QR</button>
Â  </nav>
</header>
Â  <main>
Â  Â  <!-- Info -->
Â  Â  <section id="panel-info" class="panel active">
Â  Â  Â  <h2>BMWTechWorks India</h2>
Â  Â  Â  <div class="card">
Â  Â  Â  Â  <strong>Address</strong><br>
Â  Â  Â  Â  BMWTechWorks India, 14 Offices, 1st Floor, Amar Tech Park, Balewadi, Pune, Maharashtra 411045<br>
Â  Â  Â  Â  <a href="https://maps.app.goo.gl/AmarTechParkLink" target="_blank" rel="noopener">View on Google Maps</a>
Â  Â  Â  </div>
Â  Â  Â  <p class="footer-note">Note: Photography is allowed at C & D areas only.</p>
Â  Â  </section>

Â  Â  <!-- SOS -->
Â  Â  <section id="panel-sos" class="panel">
Â  Â  Â  <h2>SOS â€“ Emergency</h2>
Â  Â  Â  <div class="grid">
Â  Â  Â  Â  <div class="card"><strong>Ambulance â€” Emergency Medical Service</strong><br>
Â  Â  Â  Â  Â  <a class="tel" href="tel:108">ğŸ“ 108</a></div>
Â  Â  Â  Â  <div class="card"><strong>Facilities BTI Team â€” Dhananjay</strong><br>
Â  Â  Â  Â  Â  <a class="tel" href="tel:+919657893928">ğŸ“ +91 9657893928</a></div>
Â  Â  Â  Â  <div class="card"><strong>Table Space Duty Cell (24Ã—7) â€” Security</strong><br>
Â  Â  Â  Â  Â  <a class="tel" href="tel:+918951322756">ğŸ“ 8951322756</a></div>
Â  Â  Â  Â  <div class="card"><strong>ATP Ambulance (24Ã—7) â€” Amar Tech Park Ambulance</strong><br>
Â  Â  Â  Â  Â  <a class="tel" href="tel:+918421737018">ğŸ“ +91 8421737018</a></div>
Â  Â  Â  Â  <div class="card"><strong>Integrated Emergency Number (24Ã—7)</strong><br>
Â  Â  Â  Â  Â  Medical, Police, Fire â€” <a class="tel" href="tel:112">ğŸ“ 112</a></div>
Â  Â  Â  Â  <div class="card"><strong>Nearest Hospital â€” Jupiter Hospital, Baner</strong><br>
Â  Â  Â  Â  Â  <a class="tel" href="tel:+912027992299">ğŸ“ 020 27992299</a></div>
Â  Â  Â  Â  <div class="card"><strong>Nearest Hospital â€” Life Point Multi Speciality Hospital, Wakad</strong><br>
Â  Â  Â  Â  Â  <a class="tel" href="tel:+912066434366">ğŸ“ 020 66434366</a> Â· <a class="tel" href="tel:+917447477993">ğŸ“ 7447477993</a></div>
Â  Â  Â  Â  <div class="card"><strong>Nearest Police Station â€” Aundh Police Station</strong><br>
Â  Â  Â  Â  Â  <a class="tel" href="tel:+912025881611">ğŸ“ 020 25881611</a></div>
Â  Â  Â  Â  <div class="card"><strong>Nearest Police Station â€” Wakad Police Station</strong><br>
Â  Â  Â  Â  Â  <a class="tel" href="tel:+912027261120">ğŸ“ 020 27261120</a></div>
Â  Â  Â  </div>Â 
Â  Â  </section>

Â  Â Â 
<section id="panel-rooms" class="panel">
Â  <h3>Meeting Rooms</h3>
Â  <div id="imgStageWrapper">
Â  Â  <div id="imgStage">
Â  Â  Â  r2.png
Â  Â  </div>
Â  </div>
Â  <div class="card">
Â  Â  <h4>Room Route Finder</h4>
Â  Â  <div class="controls-bar">
Â  Â  Â  <div class="zoom-controls">
Â  Â  Â  Â  <button id="zoomIn">ï¼‹</button>
Â  Â  Â  Â  <button id="zoomOut">ï¼</button>
Â  Â  Â  Â  <button id="reset">Reset</button>
Â  Â  Â  Â  <button id="clearRoute">Clear</button>
Â  Â  Â  </div>
Â  Â  Â  <div class="select-controls">
Â  Â  Â  Â  <label for="roomSel">Choose Meeting Room:</label>
Â  Â  Â  Â  <select id="roomSel">
Â  Â  Â  Â  Â  <option value="">â€” Select â€”</option>
Â  Â  Â  Â  Â  <option>Success</option>
Â  Â  Â  Â  Â  <option>Inspire</option>
Â  Â  Â  Â  Â  <option>Visitor</option>
Â  Â  Â  Â  Â  <option>Joy</option>
Â  Â  Â  Â  Â  <option>Debug</option>
Â  Â  Â  Â  Â  <option>iDrive</option>
Â  Â  Â  Â  Â  <option>M-Mode</option>
Â  Â  Â  Â  Â  <option>Drift</option>
Â  Â  Â  Â  Â  <option>xDrive</option>
Â  Â  Â  Â  Â  <option>Torque</option>
Â  Â  Â  Â  </select>
Â  Â  Â  </div>
Â  Â  </div>
Â  Â  <div class="steps-wrap">
Â  Â  Â  <div class="steps-column">
Â  Â  Â  Â  <ol id="routeSteps" class="muted"></ol>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>
</section>

Â  Â Â 

Â  Â  <!-- Layout & Exit -->
Â  Â  <section id="panel-layout" class="panel">
Â  Â  Â  <h3>Floor Layout & Exit</h3>
Â  Â  Â Â 
Â  Â  Â  Â  Â <div class="content">
Â  Â  Â  Â  <!-- Map: zoom/pan wrapper -->
Â  Â  Â  Â  <div class="zoom-wrap" id="zoomWrap" style="position:relative; overflow:hidden; border:1px solid #d8def0; border-radius:6px;">
Â  Â  Â  Â  Â  <!-- Optional overlay holder (SVG will be injected here if you add routes later) -->
Â  Â  Â  Â  Â  <!-- <svg id="routeOverlay" style="position:absolute; inset:0; pointer-events:none;"></svg> -->
Â  Â  Â  Â  Â  <img id="zoomImg" class="zoom-inner" src="r1.png" alt="BTI Pune Exit Plan"
Â  Â  Â  Â  Â  Â  Â  Â style="display:block; width:100%; transform-origin:0 0; user-select:nonepx;">
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <p class="muted" style="margin-top:8px">Best experienced on Chrome/Edge. Use headphones in open areas.</p>
Â  Â  Â  Â  <header style="margin-top:6px;">
Â  Â  Â  Â  Â  <div class="title" style="font-weight:600;">BTI Pune â€¢ Exit Guidance</div>
Â  Â  Â  Â  Â  <div class="controls" style="display:flex; flex-wrap:wrap; gap:6px; align-items:center;">
Â  Â  Â  Â  Â  Â  <label for="exitSelect">Exit:</label>
Â  Â  Â  Â  Â  Â  <select id="exitSelect">
Â  Â  Â  Â  Â  Â  Â  <option value="None" selected>None</option>
Â  Â  Â  Â  Â  Â  Â  <option value="EXIT1">EXIT1</option>
Â  Â  Â  Â  Â  Â  Â  <option value="EXIT2">EXIT2</option>
Â  Â  Â  Â  Â  Â  Â  <option value="EXIT3">EXIT3</option>
Â  Â  Â  Â  Â  Â  Â  <option value="EXIT4">EXIT4</option>
Â  Â  Â  Â  Â  Â  Â  <option value="EXIT5">EXIT5</option>
Â  Â  Â  Â  Â  Â  </select>

Â  Â  Â  Â  Â  Â  <label for="langSelect">Lang:</label>
Â  Â  Â  Â  Â  Â  <select id="langSelect">
Â  Â  Â  Â  Â  Â  Â  <option value="en">EN</option>
Â  Â  Â  Â  Â  Â  Â  <option value="de">DE</option>
Â  Â  Â  Â  Â  Â  </select>

Â  Â  Â  Â  Â  Â  <button class="btn" id="play">ğŸ”Š Play Audio Guidance</button>
Â  Â  Â  Â  Â  Â  <button class="btn" id="replay">Replay</button>
Â  Â  Â  Â  Â  Â  <button class="btn" id="mute">Mute</button>

Â  Â  Â  Â  Â  Â  <!-- Optional: second set of zoom buttons (header block) -->
Â  Â  Â  Â  Â  Â  <button class="btn" id="zoomOut">â– Zoom Out</button>
Â  Â  Â  Â  Â  Â  <button class="btn" id="zoomIn">â• Zoom In</button>
Â  Â  Â  Â  Â  Â  <button class="btn" id="resetView">Reset</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </header>

Â  Â  Â  Â  <!-- Guidance text display -->
Â  Â  Â  Â  <div id="routeText" class="routeText" aria-live="polite"
Â  Â  Â  Â  Â  Â  Â style="margin:8px 0; padding:8px; background:#f6f7fb; border:1px solid #d8def0; border-radius:6px;">
Â  Â  Â  Â  Â  Select an exit to see guidance.
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- Hidden audio element driven by the controls -->
Â  Â  Â  Â  <audio id="routeAudio" preload="auto" style="display:none;"></audio>

Â  Â  Â  Â  <!-- Optional: Graceful message if JS is disabled -->
Â  Â  Â  Â  <noscript>
Â  Â  Â  Â  Â  <div style="padding:12px;color:#e11d48;">
Â  Â  Â  Â  Â  Â  JavaScript is required for interactive routes and audio guidance.
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </noscript>
Â  Â  Â  </div>

Â  Â  </section>

Â  Â  <!-- ERT Members -->
Â  Â  <section id="panel-ert" class="panel">
Â  Â  Â  <h2>Emergency Response Team (ERT)</h2>
Â  Â  Â  <table>
Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  <tr><th>Department</th><th>Nominated ERT Members</th></tr>
Â  Â  Â  Â  </thead>
Â  Â  Â  Â  <tbody>
Â  Â  Â  Â  Â  <tr><td>ğŸ› ï¸ DPE</td><td>
Â  Â  Â  Â  Â  Â  ğŸ‘¤ Yogesh Tambat â€” <a class="tel" href="tel:+919921599599">ğŸ“ 9921599599</a>
Â  Â  Â  Â  Â  Â  ğŸ‘¤ Zulqurnain Khan â€” <a class="tel" href="tel:+919284564945">ğŸ“ 9284564945</a>
Â  Â  Â  Â  Â  </td></tr>
Â  Â  Â  Â  Â  <tr><td>ğŸ’» Digital Company</td><td>
Â  Â  Â  Â  Â  Â  ğŸ‘¤ Rishabh Kundal â€” <a class="tel" href="tel:+918516062226">ğŸ“ 8516062226</a>
Â  Â  Â  Â  Â  </td></tr>
Â  Â  Â  Â  Â  <tr><td>ğŸ­ Software Factory</td><td>
Â  Â  Â  Â  Â  Â  ğŸ‘¤ Sandesh Gharal â€” <a class="tel" href="tel:+919004102339">ğŸ“ 9004102339</a>
Â  Â  Â  Â  Â  Â  ğŸ‘¤ Shubham Jambekar â€” <a class="tel" href="tel:+919594607904">ğŸ“ 9594607904</a>
Â  Â  Â  Â  Â  </td></tr>
Â  Â  Â  Â  Â  <tr><td>ğŸš— Driving ECU</td><td>
Â  Â  Â  Â  Â  Â  ğŸ‘¤ Vivek Patil â€” <a class="tel" href="tel:+917499767366">ğŸ“ 7499767366</a>
Â  Â  Â  Â  Â  Â  ğŸ‘¤ Ganesh Garg â€” <a class="tel" href="tel:+917566050340">ğŸ“ 7566050340</a>
Â  Â  Â  Â  Â  </td></tr>
Â  Â  Â  Â  Â  <tr><td>ğŸ”§ SSP</td><td>
Â  Â  Â  Â  Â  Â  ğŸ‘¤ Aniket Patil â€” <a class="tel" href="tel:+919834805515">ğŸ“ 9834805515</a>
Â  Â  Â  Â  Â  Â  ğŸ‘¤ Chahul Turkar â€” <a class="tel" href="tel:+919850807794">ğŸ“ 9850807794</a>
Â  Â  Â  Â  Â  </td></tr>
Â  Â  Â  Â  Â  <tr><td>ğŸ§  AIML & Infotainment</td><td>
Â  Â  Â  Â  Â  Â  ğŸ‘¤ Pravinkumar Kale â€” <a class="tel" href="tel:+918380073079">ğŸ“ 8380073079</a>
Â  Â  Â  Â  Â  Â  ğŸ‘¤ Vipin Yadav â€” <a class="tel" href="tel:+919205768368">ğŸ“ 9205768368</a>
Â  Â  Â  Â  Â  </td></tr>
Â  Â  Â  Â  Â  <tr><td>ğŸ“¶ Connected Vehicle</td><td>
Â  Â  Â  Â  Â  Â  ğŸ‘¤ Rajiv Rengasamy â€” <a class="tel" href="tel:+919944360128">ğŸ“ 9944360128</a>
Â  Â  Â  Â  Â  Â  ğŸ‘¤ Soham Dalwadi â€” <a class="tel" href="tel:+917984473137">ğŸ“ 7984473137</a>
Â  Â  Â  Â  Â  </td></tr>
Â  Â  Â  Â  Â  <tr><td>ğŸ¢ Facilities</td><td>
Â  Â  Â  Â  Â  Â  ğŸ‘¤ Dhananjay Maske â€” <a class="tel" href="tel:+919657893928">ğŸ“ 9657893928</a>
Â  Â  Â  Â  Â  </td></tr>
Â  Â  Â  Â  Â  <tr><td>ğŸ†˜ ERT Support</td><td>
Â  Â  Â  Â  Â  Â  ğŸ‘¤ Dilip Patil â€” <a class="tel" href="tel:+919922423897">ğŸ“ 9922423897</a>;
Â  Â  Â  Â  Â  Â  ğŸ‘¤ Onkar Shintre â€” <a class="tel" href="tel:+918618301593">ğŸ“ 8618301593</a>
Â  Â  Â  Â  Â  </td></tr>
Â  Â  Â  Â  </tbody>
Â  Â  Â  </table>
Â  Â  </section>

Â  Â  <!-- First Aid & Medical Support -->
Â  Â  <section id="panel-firstaid" class="panel">
Â  Â  Â  <h2>First Aid & Medical Support</h2>
Â  Â  Â  <p>Nurse Room â€“ Floor 6 : Medical room timings are displayed on site. Wheelchair & Stretcher â€“ Available:</p>
Â  Â  Â  <img class="inset" src="NurserRoom.jpg" alt="Nurse room" />
Â  Â  Â  <img class="inset" src=FirstAidKit.jpg alt="First Aid Kit" />
Â  Â  Â  <img class="inset" src=NurseRoomMedical.jpg alt="NurseRoomMedical" />
Â  Â  Â 
Â  Â  </section>

Â  Â  <!-- Assembly Points -->
Â  Â  <section id="panel-assembly" class="panel">
Â  Â  Â  <h2>Assembly Points</h2>
Â  Â  Â  <ul>
Â  Â  Â  Â  <li>Assembly Point No.1 Near Gate No-4</li>
Â  Â  Â  Â  <li>Assembly Point No.2 Near Gate No-3</li>
Â  Â  Â  </ul>
Â  Â  Â  <img class="inset" src="Assembly Point No.1 Near Gate No-4.jpg" alt="Assembly Point 1" />
Â  Â  Â  <img class="inset" src="Assembly Point No.2 Near Gate No-3.jpg" alt="Assembly Point 2" />
Â  Â  Â Â 
Â  Â  Â  <p>General Evacuation Procedure - EarthquakeÂ 
Â  Â  Â  When you feel the tremors, protect yourself as quickly as possible. The National Disaster Management Division (NDMD), Ministry of Home Affairs, recommends the following three actions, known as Drop â€“ Cover â€“ Hold: Â DROP:- Get down on your hands and knees to prevent being knocked over. Cover:- Protect your head and neck with your arms, take shelter under a sturdy table or near an interior wall, and stay away from windows, glass, and heavy furniture. Hold :- Stay in position and hold onto your shelter until the shaking stops. Â If You Get Trapped :- Stay calm, cover your nose and mouth to protect yourself from dust, shout, whistle, or tap on nearby objects to attract attention, and remain alert for fallen electrical lines, gas leaks, or unstable structures.</p>

<p>General Evacuation Procedure - FIRE.Â 
1. If you notice a fire, activate the nearest red Manual Call Point (MCP) by breaking the glass & a fire alarm sounds as an audible beeper. 2. On hearing the alarm and PA announcement, evacuate immediately using the nearest emergency exit. 3. Do not collect bags, laptops, or valuables & Do not run, move quickly and calmly. 4.Use stairs only. Do not use lifts & assemble at the designated safe assembly area. 5.Do not re-enter until the all-clear is given by the ERT
</p>
Â  Â  </section>

Â  Â Â 

Â  Â  <!-- IT Helpdesk -->
Â  Â  <section id="panel-it" class="panel">
Â  Â  Â  <h2>IT Helpdesk</h2>
Â  Â  Â  <p>Email: <a href="mailto:ITHelpdesk.PNQ@bmwtechworks.in">ITHelpdesk.PNQ@bmwtechworks.in</a></p>
Â  Â  </section>

Â 
Â  Â  <section id="panel-translate" class="panel">
Â  Â  Â  <h2>Basic German to English Phrases</h2>
Â  Â  Â  <table>
Â  Â  Â  Â  <thead><tr><th>German</th><th>English</th></tr></thead>
Â  Â  Â  Â  <tbody>
Â  Â  Â  Â  Â  <tr><td>Hallo</td><td>Hello / Namaste</td></tr>
Â  Â  Â  Â  Â  <tr><td>Ich mÃ¶chte zu diesem Ort gehen</td><td>I want to go to this place</td></tr>
Â  Â  Â  Â  Â  <tr><td>Wie viel kostet das?</td><td>How much money?</td></tr>
Â  Â  Â  Â  Â  <tr><td>Danke</td><td>Thanks</td></tr>
Â  Â  Â  Â  Â  <tr><td>Ich mÃ¶chte das</td><td>I want this</td></tr>
Â  Â  Â  Â  Â  <tr><td>Guten Morgen</td><td>Good Morning</td></tr>
Â  Â  Â  Â  Â  <tr><td>Gute Nacht</td><td>Good Night</td></tr>
Â  Â  Â  Â  Â  <tr><td>Wo ist die Toilette?</td><td>Where is the restroom?</td></tr>
Â  Â  Â  Â  Â  <tr><td>KÃ¶nnen Sie mir helfen?</td><td>Can you help me?</td></tr>
Â  Â  Â  Â  Â  <tr><td>Ich brauche Wasser</td><td>I need water</td></tr>
Â  Â  Â  Â  </tbody>
Â  Â  Â  </table>
Â  Â  </section>

Â  Â  <!-- Parking Info -->
Â  Â  <section id="panel-parking" class="panel">
Â  Â  Â  <h2>Parking Guidelines</h2>
Â  Â  Â  <ul>
Â  Â  Â  Â  <li>Parking is strictly first-come, first-served.</li>
Â  Â  Â  Â  <li>60 slots allocated for employees at P3 and P1 levels.</li>
Â  Â  Â  Â  <li>No common parking for external visitors/vendors. They must arrange parking outside ATP premises.</li>
Â  Â  Â  </ul>
Â  Â  </section>
Â Â 


<!-- CAB -->
<section id="panel-cab" class="panel">
Â 
Â <h2>Cab Facility</h2>
<ul>
<li><a href="https://www.olacabs.com/" target="_blank">Ola</a></li>
<li><a href="https://www.uber.com/in/en/" target="_blank">Uber</a></li>
</ul>
</section>


<!-- Need Assistance -->
<section id="panel-assist" class="panel">
Â  <h2>Need Assistance</h2>
Â  <div class="grid">
Â  Â  <!-- First Level -->
Â  Â  <div class="card">
Â  Â  Â  <strong>Dhananjay Maske (First Level)</strong><br>
Â  Â  Â  Facilities Specialities, Amar Tech Park Facility, Pune<br>
Â  Â  Â  Â ğŸ‘¤ Dhananjay Maske â€” <a class="tel" href="tel:+919657893928">ğŸ“ 9657893928</a>
Â  Â  </div>

Â  Â  <!-- Second Level -->
Â  Â  <div class="card">
Â  Â  Â  <strong>Minal Pinto (Second Level)</strong><br>
Â  Â  Â  Head of Facilities &amp; Workplace, Corporate Office, Pune<br>
Â  Â  Â  ğŸ‘¤ Minal Pinto â€” <a class="tel" href="tel:+919769317569">ğŸ“ 9769317569</a>
Â  Â  </div>

Â  Â  <!-- Third Level -->
Â  Â  <div class="card">
Â  Â  Â  <strong>Vishwas Muthyala (Third Level)</strong><br>
Â  Â  Â  CHRO, Corporate Office, Pune<br>
Â  Â  Â  mailto:Vishwas.muthyala@bmwtechworks.in ğŸ“§ Email</a>
Â  Â  </div>
Â  </div>
</section>

Â  Â Â 
<!-- FOOD -->
<section id="panel-food" class="panel">
Â  <h2>Food Delivery</h2>
<ul>
<li><a href="https://www.zomato.com/" target="_blank">Zomato</a></li>
<li><a href="https://www.swiggy.com/" target="_blank">Swiggy</a></li>
</ul>
</section>

Â  Â Â 
Â  Â Â 
Â  Â Â 

<!-- SOCIAL -->
<section id="panel-social" class="panel">
<h2>Social Media & Contact</h2>
<li><a href="https://www.linkedin.com/" target="_blank">LinkedIn</a></li>
<li><a href="https://bmwtechworks.in/" target="_blank">bmwtechworks.in</a></li>
</section>


Â  Â Â 
<!-- Share / QR -->
<section id="panel-share" class="panel active">
Â <h2>Download </h2>

<!-- âœ… ID ADDED -->
<img id="siteQR" src="q_code.png" style="max-width:200px"><br><br>

<button class="btn" onclick="downloadQR()">Download QR</button>

Â  <div class="qr">
Â  Â  <div class="footer-note" style="margin-top:8px;">
Â  Â  Â  Tip: Scan this QR to open the Visitor Info page.
Â  Â  </div>
Â  </div>
</section>

Â  Â Â 


Â  Â 

Â  Â Â 
<!-- Travel Info & Converter -->
<section id="panel-travel" class="panel">
Â  <h2>Travel Info and Currency Converter</h2>
Â  <ul>
Â Â 
Â  Â  Â  <li><a href="https://www.xe.com/currencyconverter/" target="_blank">INR â†’ EUR Converter (XE)</a></li>
Â  Â  Â <li><a href="https://www.tripadvisor.in/Attractions-g297654-Activitiesarashtra.html/" target="_blank">Local Sightseeing in Pune (Tripadvisor)</a></li>
Â  Â Â 
</section>


<!-- SOCIAL -->

<section id="panel-hotels" class="panel">
Â  <h2>Near By Hotels</h2>

Â  <ul>
Â  Â  <li>
Â  Â  Â  <strong>The Urban Foundry, Baner</strong> â€”
Â  Â  <a href = "s8.devourin.com" </a>
Â  Â <a href="https://www.google.com/maps?client=ubuntu-sn&hs=buO&sca_esv=b243d552b696475b&channel=fs&uact=5&gs_lp=Egxnd3Mtd2l6LXNlcnAiGXVyYmFuIGZvdW5kYXJ5IGJhbmUgcnB1bmUyBhAAGA0YHjIFEAAY7wUyCBAAGIAEGKIEMgUQABjvBTIIEAAYgAQYogRIyDlQtgVY2zdwAngBkAEAmAHcAaAB1B-qAQYwLjIyLjO4AQPIAQD4AQGYAhugAosiqAIKwgIKEAAYsAMY1gQYR8ICFxAAGIAEGJECGLQCGOcGGIoFGOoC2AEBwgIQEAAYAxi0AhjqAhiPAdgBAcICERAuGIAEGJECGMcBGIoFGK8BwgILEAAYgAQYsQMYgwHCAhEQLhiABBixAxjRAxiDARjHAcICCxAuGIAEGNEDGMcBwgIgEC4YgAQYkQIYxwEYigUYrwEYlwUY3AQY3gQY4ATYAQLCAgoQABiABBhDGIoFwgIQEC4YgAQYQxjHARiKBRivAcICFhAuGIAEGEMYxwEYmAUYmQUYigUYrwHCAhAQABiABBixAxhDGIMBGIoFwgIOEC4YgAQYsQMY0QMYxwHCAhMQLhiABBixAxjRAxhDGMcBGIoFwgITEC4YgAQYsQMYQxjHARiKBRivAcICHxAuGIAEGEMYxwEYigUYrwEYlwUY3AQY3gQY4ATYAQLCAgUQABiABMICCBAAGIAEGLEDwgILEC4YgAQYsQMYgwHCAggQLhiABBjlBMICCxAuGIAEGMcBGK8BwgILEAAYgAQYkQIYigXCAhoQLhiABBjHARivARiXBRjcBBjeBBjgBNgBAsICDxAuGIAEGMcBGAoYCxivAcICCRAAGIAEGAoYC8ICBhAAGBYYHsICCBAAGKIEGIkFwgIHECEYoAEYCsICDRAuGIAEGMcBGA0YrwHCAgcQABiABBgNwgIIEAAYBRgNGB7CAhwQLhiABBjHARgNGK8BGJcFGNwEGN4EGOAE2AECmAML4gMFEgExIEDxBXnv-38bTGX-iAYBkAYIugYECAEYB7oGBggCEAEYFJIHBjIuMjEuNKAHoK0CsgcGMC4yMS40uAfzIcIHBjItOS4xOMgH4AGACAA&um=1&ie=UTF-8&fb=1&gl=in&sa=X&geocode=KTHi69k0ucI7MULBGYvXclGy&daddr=1,+Balewadi+High+St,+next+to+Cummins+India+Office,+Laxman+Nagar,+Balewadi,+Pune,+Maharashtra+411045" target="_blank" rel="noopener">View on Google Maps</a>
Â  Â  Â <a class="tel" href="tel:+918983001155">ğŸ“ +91 8983001155</a>
Â  Â  </li>

Â  Â  <li>
Â  Â  Â  <strong>Incognito Restaurant Bar &amp; Cafe</strong> â€”
Â  Â  Â <a href = "incognito.co.in" </a>
Â  Â  Â  <a href="https://www.google.com/maps/dir//Panchshil+Business+Park,+Baner+-+Balewadi+Rd,+Baner,+Pune,+Maharashtra+411045/@21.871743,72.911353,8z/data=!4m8!4m7!1m0!1m5!1m1!1s0x3bc2b934e0b3c567:0x1bead0e7c36e5dd7!2m2!1d73.7739887!2d18.5703494?entry=ttu&g_ep=EgoyMDI2MDEwNy4wIKXMDSoKLDEwMDc5MjA3M0gBUAM%3D" target="_blank" rel="noopener">View on Google Maps</a>
Â  Â  Â <a class="tel" href="tel:+91 8975530505">ğŸ“ +91 8975530505</a>
Â  Â  </li>
Â  </ul>
</section>



Â  Â Â 

Â  </main>

Â  Â <p class="footer-note">ğŸ”’ No personal data collected â€¢ No cookies â€¢ Works offline after first load</p>

  <p class="footer-note"> @Copyright  & Developed By</p>
Â  <footer style="text-align:center; padding:10px; color:var(--muted)">
     BMW-BTI-Digital CAR PUNE-SSP Team-2026</div>
</footer>
Â Â 

Â  <script>
Â  Â  // Tab router: show one panel, hide others
Â  Â  const buttons = document.querySelectorAll('button.nav');
Â  Â  const panels = document.querySelectorAll('section.panel');

Â  Â  function showPanel(key){
Â  Â  Â  buttons.forEach(b=>b.classList.toggle('active', b.dataset.panel===key));
Â  Â  Â  panels.forEach(p=>p.classList.toggle('active', p.id==='panel-'+key));
Â  Â  Â  window.scrollTo({top:0, behavior:'smooth'});
Â  Â  }

Â  Â  buttons.forEach(b=>{
Â  Â  Â  b.addEventListener('click', e=>{
Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  showPanel(b.dataset.panel);
Â  Â  Â  });
Â  Â  });

Â  Â  document.getElementById('download-qr')?.addEventListener('click', e=>{
Â  Â  Â  e.preventDefault();
Â  Â  });

Â  Â  Â // Zoom & Pan
const stage = document.getElementById('imgStage');
const img = document.getElementById('floorImg');
let scale = 1, tx = 0, ty = 0, isDown = false, lastX = 0, lastY = 0;

function applyTransform() {
Â  stage.style.transform = `translate(${tx}px, ${ty}px) scale(${scale})`;
}
function zoom(delta) {
Â  scale = Math.min(3.5, Math.max(1, scale + delta));
Â  applyTransform();
}
document.getElementById('zoomIn').onclick = () => zoom(0.25);
document.getElementById('zoomOut').onclick = () => zoom(-0.25);
document.getElementById('reset').onclick = () => { scale = 1; tx = 0; ty = 0; applyTransform(); };

stage.addEventListener('mousedown', e => { isDown = true; lastX = e.clientX; lastY = e.clientY; stage.classList.add('grabbing'); });
window.addEventListener('mouseup', () => { isDown = false; stage.classList.remove('grabbing'); });
window.addEventListener('mousemove', e => {
Â  if (!isDown) return;
Â  tx += e.clientX - lastX; ty += e.clientY - lastY;
Â  lastX = e.clientX; lastY = e.clientY;
Â  applyTransform();
});
stage.addEventListener('wheel', e => { e.preventDefault(); zoom(e.deltaY > 0 ? -0.2 : 0.2); });

// Route steps
const routeData = {
Â  Success: ["Start at Reception.", "Walk north towards Visitor area.", "Pass Visitor Room.", "Turn right beyond Visitor.", "Success is first glass-walled room on left."],
Â  Inspire: ["Start at Reception.", "Walk north towards Visitor area.", "Continue straight after Visitor.", "Inspire is next on left, adjacent to Success."],
Â  Visitor: ["Start at Reception.", "Visitor Room is directly ahead-left from Reception."],
Â  Joy: ["Start at Reception.", "Joy is immediately to the right of Reception."],
Â  Debug: ["Start at Reception.", "Head east along main aisle.", "Continue straight into central block.", "Debug is in middle section."],
Â  iDrive: ["Start at Reception.", "Head east along main aisle past central area.", "Enter right-middle cluster.", "iDrive is first meeting room."],
Â  "M-Mode": ["Start at Reception.", "Head east along main aisle.", "Enter right-middle cluster.", "M-Mode is adjacent to iDrive."],
Â  Drift: ["Start at Reception.", "Walk east towards far right wing.", "Drift is first meeting room in inner row."],
Â  xDrive: ["Start at Reception.", "Continue to far right wing.", "xDrive is next after Drift."],
Â  Torque: ["Start at Reception.", "Proceed to far right wing.", "Torque is last meeting room beyond xDrive."]
};

const roomSel = document.getElementById('roomSel');
const stepsOl = document.getElementById('routeSteps');
document.getElementById('clearRoute').onclick = () => { roomSel.value = ''; stepsOl.innerHTML = ''; };
roomSel.onchange = () => {
Â  stepsOl.innerHTML = '';
Â  const steps = routeData[roomSel.value] || [];
Â  steps.forEach(s => {
Â  Â  const li = document.createElement('li');
Â  Â  li.textContent = s;
Â  Â  stepsOl.appendChild(li);
Â  });
};
Â  Â Â 
Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  /* =========================================
Â  Â  Â BTI Pune â€¢ Exit Guidance (TTS only)
Â  Â  Â - Force default EXIT1 via JS
Â  Â  Â - Text visible immediately on load/change
Â  Â  Â - Play/Replay enabled for EXIT1..EXIT5
Â  Â  Â - Reset sets Exit=None + default message
Â  Â  Â ========================================= */

Â  /* -------- Guidance (EN/DE) -------- */
Â  const GUIDANCE = {
Â  Â  en: {
Â  Â  Â  EXIT1: "From your current location, move west along the main corridor; at the junction turn north to reach the West Exit (near Success â€“ Board room).",
Â  Â  Â  EXIT2: "Head west and then south along the corridor to the Southâ€‘West Exit (near Joy).",
Â  Â  Â  EXIT3: "Proceed towards the central corridor and continue north to the Central Exit (near Debug).",
Â  Â  Â  EXIT4: "Go east along the main corridor; at the next junction turn north to reach the East Exit (near iDrive/Mâ€‘Mode).",
Â  Â  Â  EXIT5: "Continue east to the far right wing and turn south to reach the Farâ€‘East Exit (near Xdrive/Torque)."
Â  Â  },
Â  Â  de: {
Â  Â  Â  EXIT1: "Gehen Sie nach Westen entlang des Hauptflurs; biegen Sie an der Kreuzung nach Norden ab zum Westausgang (bei Success â€“ Board room).",
Â  Â  Â  EXIT2: "Gehen Sie nach Westen und dann nach SÃ¼den entlang des Flurs zum SÃ¼dwestausgang (bei Joy).",
Â  Â  Â  EXIT3: "Gehen Sie zum zentralen Flur und weiter nach Norden zum Zentralausgang (bei Debug).",
Â  Â  Â  EXIT4: "Gehen Sie nach Osten entlang des Hauptflurs; biegen Sie an der nÃ¤chsten Kreuzung nach Norden ab zum Ostausgang (bei iDrive/Mâ€‘Mode).",
Â  Â  Â  EXIT5: "Gehen Sie weiter nach Osten bis zum rechten FlÃ¼gel und biegen Sie nach SÃ¼den ab zum ganz rechten Ostausgang (bei Xdrive/Torque)."
Â  Â  }
Â  };

Â  /* -------- DOM refs -------- */
Â  const zoomWrap Â  Â  Â = document.getElementById('zoomWrap');
Â  const zoomImg Â  Â  Â  = document.getElementById('zoomImg');

Â  const btnSpeak Â  Â  Â = document.getElementById('btnSpeak');
Â  const btnStop Â  Â  Â  = document.getElementById('btnStop');
Â  const btnReset Â  Â  Â = document.getElementById('btnReset');
Â  const btnZoomIn Â  Â  = document.getElementById('btnZoomIn');
Â  const btnZoomOut Â  Â = document.getElementById('btnZoomOut');
Â  const btnFullscreen = document.getElementById('btnFullscreen');

Â  const exitSelect Â  Â = document.getElementById('exitSelect');
Â  const langSelect Â  Â = document.getElementById('langSelect');

Â  const playHeader Â  Â = document.getElementById('play');
Â  const replayHeader Â = document.getElementById('replay');
Â  const muteHeader Â  Â = document.getElementById('mute');

Â  const zoomOutHeader = document.getElementById('zoomOut');
Â  const zoomInHeader Â = document.getElementById('zoomIn');
Â  const resetHeader Â  = document.getElementById('resetView');

Â  const routeText Â  Â  = document.getElementById('routeText');
Â  const routeAudio Â  Â = document.getElementById('routeAudio'); // unused in TTS mode

Â  /* -------- Normalizers -------- */
Â  function normalizeExit(v){ return String(v || '').trim().toUpperCase(); }
Â  function normalizeLang(v){ v = String(v || '').trim().toLowerCase(); return v === 'de' ? 'de' : 'en'; }

Â  /* -------- Helpers -------- */
Â  function isValidExit(val){ val = normalizeExit(val); return ['EXIT1','EXIT2','EXIT3','EXIT4','EXIT5'].includes(val); }
Â  function isNone(val){ return normalizeExit(val) === 'NONE'; }
Â  function defaultMessage(lang){ return lang==='de' ? 'WÃ¤hlen Sie einen Ausgang aus, um die Anleitung zu sehen.' : 'Select an exit to see guidance.'; }
Â  function setButtonsEnabled(enabled){
Â  Â  if (btnSpeak) Â  Â  btnSpeak.disabled Â  Â  = !enabled;
Â  Â  if (playHeader) Â  playHeader.disabled Â  = !enabled;
Â  Â  if (replayHeader) replayHeader.disabled = !enabled;
Â  Â  if (btnStop) Â  Â  Â btnStop.disabled Â  Â  Â = false;
Â  Â  if (btnReset) Â  Â  btnReset.disabled Â  Â  = false;
Â  Â  if (muteHeader) Â  muteHeader.disabled Â  = false;
Â  }

Â  /* -------- Force default EXIT1 (no HTML edits needed) -------- */
Â  if (exitSelect) {
Â  Â  exitSelect.value = 'EXIT1'; // set default
Â  Â  // If your markup has "None" first, it will be overridden by this.
Â  }

Â  /* -------- State (after forcing EXIT1) -------- */
Â  let currentExit = normalizeExit(exitSelect?.value || 'EXIT1');
Â  let currentLang = normalizeLang(langSelect?.value || 'en');
Â  let isMuted = false;
Â  let voices = [];
Â  let activeUtterance = null;

Â  /* -------- Guidance text render -------- */
Â  function guidanceText(){
Â  Â  if (!isValidExit(currentExit)) return defaultMessage(currentLang);
Â  Â  const phrases = GUIDANCE[currentLang] || GUIDANCE.en;
Â  Â  return phrases[currentExit] || defaultMessage(currentLang);
Â  }
Â  function updateGuidanceUI(){
Â  Â  const header = isValidExit(currentExit) ? `${currentExit} â€¢ ${currentLang.toUpperCase()}` : `${currentLang.toUpperCase()}`;
Â  Â  routeText.textContent = `${header} â€¢ ${guidanceText()}`;
Â  Â  setButtonsEnabled(isValidExit(currentExit));
Â  }

Â  /* -------- Speech synthesis -------- */
Â  function loadVoices(){ try { voices = window.speechSynthesis.getVoices() || []; } catch { voices = []; } }
Â  loadVoices();
Â  if (typeof window.speechSynthesis !== 'undefined'){ window.speechSynthesis.onvoiceschanged = loadVoices; }
Â  function pickVoice(lang){
Â  Â  const prefer = lang==='de' ? ['de-DE','de-AT','de'] : ['en-US','en-GB','en'];
Â  Â  for (const code of prefer){ const v = voices.find(voice => (voice.lang||'').toLowerCase() === code.toLowerCase()); if (v) return v; }
Â  Â  const v2 = voices.find(voice => (voice.lang||'').toLowerCase().startsWith(lang==='de' ? 'de' : 'en'));
Â  Â  return v2 || voices[0] || null;
Â  }
Â  function speakGuidance(){
Â  Â  if (!isValidExit(currentExit)){
Â  Â  Â  updateGuidanceUI();
Â  Â  Â  return;
Â  Â  }
Â  Â  if (typeof window.speechSynthesis === 'undefined'){
Â  Â  Â  routeText.textContent = 'Speech not supported on this browser. Please use Chrome/Edge.';
Â  Â  Â  return;
Â  Â  }
Â  Â  try { window.speechSynthesis.cancel(); } catch {}
Â  Â  activeUtterance = new SpeechSynthesisUtterance(guidanceText());
Â  Â  activeUtterance.lang = (currentLang==='de') ? 'de-DE' : 'en-US';
Â  Â  const voice = pickVoice(currentLang);
Â  Â  if (voice) activeUtterance.voice = voice;
Â  Â  activeUtterance.rate = 1.0; activeUtterance.pitch = 1.0; activeUtterance.volume = isMuted ? 0 : 1;

Â  Â  activeUtterance.onstart = () => { if (btnSpeak) btnSpeak.textContent = 'ğŸ”Š Playing'; if (playHeader) playHeader.textContent = 'Playing'; };
Â  Â  activeUtterance.onend Â  = () => { if (btnSpeak) btnSpeak.textContent = 'ğŸ”Š Play Audio Guidance'; if (playHeader) playHeader.textContent = 'Play'; };
Â  Â  activeUtterance.onerror = (e) => { console.error('Speech synthesis error:', e); routeText.textContent = 'Unable to play synthesized audio. Try again.'; setButtonsEnabled(true); };

Â  Â  window.speechSynthesis.speak(activeUtterance);
Â  }
Â  function stopSpeech(){
Â  Â  try { window.speechSynthesis.cancel(); } catch {}
Â  Â  activeUtterance = null;
Â  Â  if (btnSpeak) btnSpeak.textContent = 'ğŸ”Š Play Audio Guidance';
Â  Â  if (playHeader) playHeader.textContent = 'Play';
Â  }
Â  function replaySpeech(){ stopSpeech(); speakGuidance(); }
Â  function toggleMute(){
Â  Â  isMuted = !isMuted;
Â  Â  if (muteHeader) muteHeader.textContent = isMuted ? 'Unmute' : 'Mute';
Â  Â  if (activeUtterance) replaySpeech(); // apply new volume
Â  }

Â  /* -------- Init (render text immediately) -------- */
Â  function init(){
Â  Â  if (routeAudio) routeAudio.style.display = 'none'; // unused in TTS mode
Â  Â  updateGuidanceUI(); // TEXT VISIBLE ON LOAD for EXIT1
Â  }
Â  init();

Â  /* -------- Dropdown handlers (text updates instantly) -------- */
Â  exitSelect?.addEventListener('change', () => {
Â  Â  currentExit = normalizeExit(exitSelect.value);
Â  Â  updateGuidanceUI(); // TEXT VISIBLE IMMEDIATELY ON EXIT CHANGE
Â  });
Â  langSelect?.addEventListener('change', () => {
Â  Â  currentLang = normalizeLang(langSelect.value);
Â  Â  updateGuidanceUI(); // TEXT VISIBLE IMMEDIATELY ON LANG CHANGE
Â  Â  loadVoices();
Â  });

Â  /* -------- Buttons (both blocks) -------- */
Â  btnSpeak?.addEventListener('click', speakGuidance);
Â  btnStop?.addEventListener('click', stopSpeech);
Â  btnReset?.addEventListener('click', resetAll);
Â  btnZoomIn?.addEventListener('click', () => zoomBy(0.25));
Â  btnZoomOut?.addEventListener('click', () => zoomBy(-0.25));
Â  btnFullscreen?.addEventListener('click', toggleFullscreen);

Â  playHeader?.addEventListener('click', speakGuidance);
Â  replayHeader?.addEventListener('click', replaySpeech);
Â  muteHeader?.addEventListener('click', toggleMute);
Â  zoomInHeader?.addEventListener('click', () => zoomBy(0.25));
Â  zoomOutHeader?.addEventListener('click', () => zoomBy(-0.25));
Â  resetHeader?.addEventListener('click', resetAll);

Â  /* -------- Reset (speech + view + state + text) -------- */
Â  function resetAll(){
Â  Â  stopSpeech(); Â  // stop TTS
Â  Â  resetView(); Â  Â // reset pan/zoom
Â  Â  if (exitSelect) exitSelect.value = 'None'; // programmatically set None
Â  Â  currentExit = 'None';
Â  Â  updateGuidanceUI(); // show default message + disable Play/Replay
Â  }

Â  /* -------- Map: zoom / pan / fullscreen -------- */
Â  let scale = 1, tx = 0, ty = 0;
Â  function applyTransform(){ if (!zoomImg) return; const t = `translate(${tx}px, ${ty}px) scale(${scale})`; zoomImg.style.transformOrigin = '0 0'; zoomImg.style.transform = t; }
Â  function zoomBy(delta){ scale = Math.max(0.5, Math.min(4, scale + delta)); applyTransform(); }
Â  function resetView(){ scale = 1; tx = 0; ty = 0; applyTransform(); }
Â  function toggleFullscreen(){ if (!document.fullscreenElement){ zoomWrap?.requestFullscreen?.().catch(()=>{}); } else { document.exitFullscreen?.(); } }

Â  // Panning
Â  let dragging = false, sx = 0, sy = 0;
Â  zoomWrap?.addEventListener('pointerdown', (e) => { dragging = true; zoomWrap.setPointerCapture(e.pointerId); sx = e.clientX - tx; sy = e.clientY - ty; });
Â  zoomWrap?.addEventListener('pointermove', (e) => { if (!dragging) return; tx = e.clientX - sx; ty = e.clientY - sy; applyTransform(); });
Â  zoomWrap?.addEventListener('pointerup', Â  (e) => { dragging = false; zoomWrap.releasePointerCapture(e.pointerId); });

Â  // Keyboard shortcuts
Â  document.addEventListener('keydown', (e) => {
Â  Â  if (e.key === '+') zoomBy(0.25);
Â  Â  if (e.key === '-') zoomBy(-0.25);
Â  Â  if (e.key.toLowerCase() === 'r') resetAll();
Â  Â  if (e.key.toLowerCase() === 'f') toggleFullscreen();
Â  });
});


Â  Â  // Data
Â  Â  const routePaths = {
Â  Â  Â  Success:[[0.120,0.550],[0.100,0.480],[0.080,0.360],[0.060,0.300]],
Â  Â  Â  Inspire:[[0.120,0.550],[0.100,0.480],[0.085,0.400]],
Â  Â  Â  Joy:[[0.120,0.550],[0.140,0.560]],
Â  Â  Â  Debug:[[0.120,0.550],[0.300,0.550],[0.410,0.520]],
Â  Â  Â  iDrive:[[0.120,0.550],[0.300,0.550],[0.530,0.540]],
Â  Â  Â  'M-Mode':[[0.120,0.550],[0.300,0.550],[0.640,0.560]],
Â  Â  Â  Drift:[[0.120,0.550],[0.300,0.550],[0.740,0.560],[0.800,0.560]],
Â  Â  Â  xDrive:[[0.120,0.550],[0.300,0.550],[0.820,0.550],[0.880,0.540]],
Â  Â  Â  Torque:[[0.120,0.550],[0.300,0.550],[0.860,0.540],[0.940,0.540]]
Â  Â  };

Â  Â  const routeText = {
Â  Â  Â  en: {
Â  Â  Â  Â  Success: ['Reception â†’ left corridor', 'Proceed up to board room', 'Success (Board)'],
Â  Â  Â  Â  Inspire: ['Reception â†’ left corridor', 'Training room next to Success'],
Â  Â  Â  Â  Joy: ['Reception â†’ left corridor', 'Joy is near Visitor area'],
Â  Â  Â  Â  Debug: ['Reception â†’ main corridor', 'Continue to middle section', 'Debug lab is at center'],
Â  Â  Â  Â  iDrive: ['Reception â†’ main corridor', 'Pass Debug', 'iDrive opposite Debug'],
Â  Â  Â  Â  'M-Mode': ['Reception â†’ main corridor', 'Turn right', 'Mâ€‘Mode corner room'],
Â  Â  Â  Â  Drift: ['Reception â†’ main corridor', 'Turn right into side corridor â†’ Tâ€‘junction', 'Drift next to xDrive'],
Â  Â  Â  Â  xDrive: ['Reception â†’ main corridor', 'Turn right into side corridor', 'xDrive near Torque'],
Â  Â  Â  Â  Torque: ['Reception â†’ far right end', 'Opposite xDrive', 'Torque room']
Â  Â  Â  },
Â  Â  Â  de: {
Â  Â  Â  Â  Success:['Empfang â†’ linker Flur','Bis zum Boardroom','Success (Board)'],
Â  Â  Â  Â  Inspire:['Empfang â†’ linker Flur','Schulungsraum neben Success'],
Â  Â  Â  Â  Joy:['Empfang â†’ linker Flur','Joy nahe Besucherbereich'],
Â  Â  Â  Â  Debug:['Empfang â†’ Hauptflur','Weiter zum Mittelteil','Debugâ€‘Labor im Zentrum'],
Â  Â  Â  Â  iDrive:['Empfang â†’ Hauptflur','An Debug vorbei','iDrive gegenÃ¼ber Debug'],
Â  Â  Â  Â  'M-Mode':['Empfang â†’ Hauptflur','Nach rechts abbiegen','Mâ€‘Mode Eckraum'],
Â  Â  Â  Â  Drift:['Empfang â†’ Hauptflur','Rechts in Seitenflur â†’ Tâ€‘Kreuzung','Drift neben xDrive'],
Â  Â  Â  Â  xDrive:['Empfang â†’ Hauptflur','Rechts in Seitenflur','xDrive nahe Torque'],
Â  Â  Â  Â  Torque:['Empfang â†’ ganz rechts','GegenÃ¼ber xDrive','Torqueâ€‘Raum']
Â  Â  Â  }
Â  Â  };

Â  Â  // Pan/zoom
Â  Â  const layer = document.getElementById('planLayer');
Â  Â  const svg = document.getElementById('routeSvg'); // present but unused for drawing
Â  Â  let scale = 1, tx = 0, ty = 0; let dragging = false, px = 0, py = 0;
Â  Â  function apply(){ layer.style.transform = `translate(${tx}px, ${ty}px) scale(${scale})`; }
Â  Â  apply();
Â  Â  document.getElementById('zoomIn').onclick = ()=>{ scale = Math.min(4, scale + 0.15); apply(); };
Â  Â  document.getElementById('zoomOut').onclick = ()=>{ scale = Math.max(0.5, scale - 0.15); apply(); };

Â  Â  // Reset: clear text + audio and reset view (+ empty dropdown)
Â  Â  const sel = document.getElementById('roomSel');
Â  Â  const steps = document.getElementById('routeSteps');

Â  Â  document.getElementById('reset').onclick = ()=>{
Â  Â  Â  scale = 1; tx = 0; ty = 0; apply();
Â  Â  Â  clearSvg(); steps.innerHTML=''; stopTTS(); sel.value='';
Â  Â  };

Â  Â  layer.addEventListener('pointerdown', (e)=>{ dragging = true; px = e.clientX; py = e.clientY; layer.setPointerCapture(e.pointerId); });
Â  Â  layer.addEventListener('pointermove', (e)=>{ if(!dragging) return; const dx = e.clientX - px; const dy = e.clientY - py; tx += dx; ty += dy; px = e.clientX; py = e.clientY; apply(); });
Â  Â  layer.addEventListener('pointerup', ()=> dragging=false);

Â  Â  // No route drawing
Â  Â  function clearSvg(){ if(svg) svg.innerHTML=''; }
Â  Â  function drawRoute(room){ clearSvg(); return; }

Â  Â  // Selection + language (text + TTS only)
Â  Â  let currentLang = (new URLSearchParams(location.search)).get('lang') || 'en';

Â  Â  function selectRoom(room){
Â  Â  Â  if(!room){ steps.innerHTML=''; clearSvg(); stopTTS(); return; }
Â  Â  Â  sel.value = room;
Â  Â  Â  steps.innerHTML='';
Â  Â  Â  (routeText[currentLang][room]||[]).forEach(s=>{ const li=document.createElement('li'); li.textContent=s; steps.appendChild(li); });
Â  Â  Â  // drawRoute(room); // intentionally not drawing any route
Â  Â  Â  updateVoiceStatus();
Â  Â  }

Â  Â  sel.addEventListener('change', ()=> selectRoom(sel.value));
Â  Â  document.getElementById('langToggle').onclick = ()=>{ currentLang = (currentLang==='en')?'de':'en'; selectRoom(sel.value); };

Â  Â  // Audio via Web Speech API (TTS)
Â  Â  const audioStatus = document.getElementById('audioStatus');
Â  Â  let voices = []; function loadVoices(){ voices = window.speechSynthesis.getVoices(); }
Â  Â  loadVoices(); window.speechSynthesis.onvoiceschanged = loadVoices;

Â  Â  function pickVoice(langCode){
Â  Â  Â  const exact = voices.find(v=>v.lang.toLowerCase()===langCode.toLowerCase());
Â  Â  Â  if(exact) return exact;
Â  Â  Â  const prefix = langCode.split('-')[0];
Â  Â  Â  const starts = voices.find(v=>v.lang.toLowerCase().startsWith(prefix.toLowerCase()));
Â  Â  Â  if(starts) return starts;
Â  Â  Â  return voices[0] || null;
Â  Â  }

Â  Â  function buildSpeechText(room, lang){ const lines = routeText[lang][room] || []; return lines.join('. '); }

Â  Â  let currentUtterance = null;
Â  Â  function stopTTS(){ if(currentUtterance){ window.speechSynthesis.cancel(); currentUtterance = null; } else { window.speechSynthesis.cancel(); } audioStatus.textContent = ''; }

Â  Â  function speakSteps(room, lang){
Â  Â  Â  stopTTS();
Â  Â  Â  if(!room){ audioStatus.textContent='Select a room first.'; return; }
Â  Â  Â  const text = buildSpeechText(room, lang);
Â  Â  Â  if(!text){ audioStatus.textContent = 'No audio text available.'; return; }
Â  Â  Â  const voice = pickVoice(lang==='de' ? 'de-DE' : 'en-US');
Â  Â  Â  const utter = new SpeechSynthesisUtterance(text);
Â  Â  Â  if(voice) utter.voice = voice;
Â  Â  Â  utter.rate = 1.0; utter.pitch = 1.0;
Â  Â  Â  utter.onstart = ()=>{ audioStatus.textContent = `Speaking (${(voice && voice.lang) || (lang==='de'?'de-DE':'en-US')})â€¦`; };
Â  Â  Â  utter.onend Â  = ()=>{ audioStatus.textContent = 'Done.'; setTimeout(()=> audioStatus.textContent='', 800); };
Â  Â  Â  utter.onerror = ()=>{ audioStatus.textContent = 'Speech error. Try again.'; };
Â  Â  Â  currentUtterance = utter;
Â  Â  Â  window.speechSynthesis.speak(utter);
Â  Â  }

Â  Â  document.getElementById('playAudio').onclick = ()=> speakSteps(sel.value, currentLang);
Â  Â  document.getElementById('stopAudio').onclick = ()=> stopTTS();

Â  Â  // Clear: text + audio (keeps zoom/pan)
Â  Â  document.getElementById('clearRoute').onclick = ()=>{ clearSvg(); steps.innerHTML=''; stopTTS(); sel.value=''; };

Â  Â  // Deep link (shows text + TTS only)
Â  Â  const qs = new URLSearchParams(location.search);
Â  Â  const initialRoom = qs.get('room');
Â  Â  if(initialRoom && routeText.en[initialRoom]){ sel.value = initialRoom; selectRoom(initialRoom); }

Â  Â Â 
Â  Â  (function(){
Â  // --- Rooms seen on the plan (approximate % positions relative to image natural size) ---
Â  // r2.png natural size is ~890 x 404 (W x H). We'll define coordinates as percentages.
Â  const rooms = [
Â  Â  {name:'Success', label:'Success â€“ Board room', xPct: 10.0, yPct: 15.0}, Â // left-top cluster
Â  Â  {name:'Inspire', label:'Inspire â€“ Training room', xPct: 11.5, yPct: 35.0},
Â  Â  {name:'Visitor', label:'Visitor Room', xPct: 10.5, yPct: 50.0},
Â  Â  {name:'Joy', Â  Â  label:'Joy', xPct: 20.5, yPct: 60.0},

Â  Â  {name:'Debug', Â  label:'Debug', xPct: 44.0, yPct: 50.0}, Â  Â  Â  Â  Â  Â  Â  Â  Â // middle
Â  Â  {name:'iDrive', Â label:'iDrive', xPct: 58.5, yPct: 52.0},
Â  Â  {name:'M-Mode', Â label:'M-Mode', xPct: 67.5, yPct: 52.0},
Â  Â  {name:'Drift', Â  label:'Drift', xPct: 77.5, yPct: 52.0},
Â  Â  {name:'Xdrive', Â label:'Xdrive', xPct: 85.5, yPct: 52.0},
Â  Â  {name:'Torque', Â label:'Torque', xPct: 92.5, yPct: 52.0}
Â  ];

Â  // --- Corridor graph (approx) ---
Â  // Horizontal main corridor ~60â€“65% down the image across width.
Â  // Junctions across the main corridor (x from left to right). yPct ~64.
Â  const corridorJunctions = [
Â  Â  {id:'J1', xPct: 14.5, yPct: 64.0},
Â  Â  {id:'J2', xPct: 44.0, yPct: 64.0}, // near Debug vertical
Â  Â  {id:'J3', xPct: 58.5, yPct: 64.0},
Â  Â  {id:'J4', xPct: 67.5, yPct: 64.0},
Â  Â  {id:'J5', xPct: 77.5, yPct: 64.0},
Â  Â  {id:'J6', xPct: 85.5, yPct: 64.0},
Â  Â  {id:'J7', xPct: 92.5, yPct: 64.0}
Â  ];
Â  // Vertical left spine connecting upper left cluster to main corridor
Â  const leftSpineTop = {id:'LTop', xPct: 14.5, yPct: 18.0};
Â  const leftSpineMid = {id:'LMid', xPct: 14.5, yPct: 35.0};
Â  const leftSpineLow = {id:'LLow', xPct: 14.5, yPct: 50.0};

Â  // Edges among corridor nodes (undirected)
Â  const edges = [
Â  Â  ['J1','J2'], ['J2','J3'], ['J3','J4'], ['J4','J5'], ['J5','J6'], ['J6','J7'],
Â  Â  ['LTop','LMid'], ['LMid','LLow'], ['LLow','J1'] // left vertical spine down to main corridor
Â  ];

Â  // Room connectors to nearest junctions/spines
Â  const connectors = {
Â  Â  'Success': 'LTop',
Â  Â  'Inspire': 'LMid',
Â  Â  'Visitor': 'LLow',
Â  Â  'Joy': Â  Â  'J1',
Â  Â  'Debug': Â  'J2',
Â  Â  'iDrive': Â 'J3',
Â  Â  'M-Mode': Â 'J4',
Â  Â  'Drift': Â  'J5',
Â  Â  'Xdrive': Â 'J6',
Â  Â  'Torque': Â 'J7'
Â  };

Â  // Build node map (corridor + spine nodes + room nodes)
Â  const nodes = {};
Â  [...corridorJunctions, leftSpineTop, leftSpineMid, leftSpineLow].forEach(n => nodes[n.id] = n);
Â  // Add synthetic "room nodes" (for path start/end) connected to their connector
Â  rooms.forEach(r => {
Â  Â  const id = `R:${r.name}`;
Â  Â  nodes[id] = {id, xPct:r.xPct, yPct:r.yPct};
Â  Â  edges.push([id, connectors[r.name]]);
Â  });

Â  // Helper: shortest path on the graph (Dijkstra with unit weights)
Â  function shortestPath(startId, endId) {
Â  Â  const adj = {};
Â  Â  Object.keys(nodes).forEach(k => adj[k] = []);
Â  Â  edges.forEach(([a,b]) => { adj[a].push(b); adj[b].push(a); });

Â  Â  const dist = {}, prev = {}, Q = new Set(Object.keys(nodes));
Â  Â  Object.keys(nodes).forEach(k => dist[k] = Infinity);
Â  Â  dist[startId] = 0;

Â  Â  while (Q.size) {
Â  Â  Â  // find min-distance node in Q
Â  Â  Â  let u = null, best = Infinity;
Â  Â  Â  for (const k of Q) { if (dist[k] < best) { best = dist[k]; u = k; } }
Â  Â  Â  if (u === null) break;
Â  Â  Â  Q.delete(u);
Â  Â  Â  if (u === endId) break;
Â  Â  Â  for (const v of adj[u]) {
Â  Â  Â  Â  const alt = dist[u] + 1;
Â  Â  Â  Â  if (alt < dist[v]) { dist[v] = alt; prev[v] = u; }
Â  Â  Â  }
Â  Â  }
Â  Â  // reconstruct path
Â  Â  const path = [];
Â  Â  let u = endId;
Â  Â  if (!(u in prev) && u !== startId) {
Â  Â  Â  // unreachable (shouldn't happen with our simple graph)
Â  Â  Â  return [startId, endId];
Â  Â  }
Â  Â  while (u !== undefined) {
Â  Â  Â  path.unshift(u);
Â  Â  Â  if (u === startId) break;
Â  Â  Â  u = prev[u];
Â  Â  }
Â  Â  return path;
Â  }

Â  // Directions generator (English + German) based on path geometry
Â  function directionsForPath(path) {
Â  Â  // Convert node ids into coordinates
Â  Â  const pts = path.map(id => nodes[id]);
Â  Â  const stepsEN = [];
Â  Â  const stepsDE = [];

Â  Â  function step(en,de){ stepsEN.push(en); stepsDE.push(de); }

Â  Â  const startRoom = path[0].startsWith('R:') ? path[0].slice(2) : 'Start';
Â  Â  const endRoom Â  = path[path.length-1].startsWith('R:') ? path[path.length-1].slice(2) : 'End';

Â  Â  step(`Start at ${startRoom}.`, `Beginne bei ${startRoom}.`);

Â  Â  for (let i=1;i<pts.length;i++){
Â  Â  Â  const a = pts[i-1], b = pts[i];
Â  Â  Â  const dx = b.xPct - a.xPct;
Â  Â  Â  const dy = b.yPct - a.yPct;
Â  Â  Â  const horiz = Math.abs(dx) > Math.abs(dy);

Â  Â  Â  if (horiz) {
Â  Â  Â  Â  if (dx > 0) {
Â  Â  Â  Â  Â  step(`Proceed east along the main corridor.`, `Gehe nach Osten entlang des Hauptkorridors.`);
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  step(`Proceed west along the main corridor.`, `Gehe nach Westen entlang des Hauptkorridors.`);
Â  Â  Â  Â  }
Â  Â  Â  } else {
Â  Â  Â  Â  if (dy > 0) {
Â  Â  Â  Â  Â  step(`Head south to the lower junction.`, `Gehe nach SÃ¼den zur unteren Kreuzung.`);
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  step(`Head north to the upper junction.`, `Gehe nach Norden zur oberen Kreuzung.`);
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  }
Â  Â  step(`Turn towards ${endRoom} and enter.`, `Biege zu ${endRoom} ab und betrete den Raum.`);

Â  Â  return {en:stepsEN, de:stepsDE};
Â  }

Â  // --- DOM wiring ---
Â  const panel = document.getElementById('panel-rooms');
Â  const stage = document.getElementById('imgStage');
Â  const img Â  = document.getElementById('floorImg');
Â  const canvas= document.getElementById('routeCanvas');
Â  const ctx Â  = canvas.getContext('2d');

Â  const zoomInBtn = document.getElementById('zoomIn');
Â  const zoomOutBtn= document.getElementById('zoomOut');
Â  const zoomResetBtn = document.getElementById('zoomReset');

Â  const fromSel = document.getElementById('fromRoom');
Â  const toSel Â  = document.getElementById('toRoom');
Â  const showBtn = document.getElementById('showRoute');

Â  const stepsEN = document.getElementById('routeStepsEN');
Â  const stepsDE = document.getElementById('routeStepsDE');

Â  const playEN = document.getElementById('playEN');
Â  const playDE = document.getElementById('playDE');

Â  // Populate selects
Â  function populateSelects(){
Â  Â  const options = ['','Success','Inspire','Visitor','Joy','Debug','iDrive','M-Mode','Drift','Xdrive','Torque'];
Â  Â  function fill(sel){
Â  Â  Â  sel.innerHTML = '';
Â  Â  Â  options.forEach(v => {
Â  Â  Â  Â  const opt = document.createElement('option');
Â  Â  Â  Â  opt.value = v;
Â  Â  Â  Â  opt.textContent = v ? v : 'â€” Select â€”';
Â  Â  Â  Â  sel.appendChild(opt);
Â  Â  Â  });
Â  Â  }
Â  Â  fill(fromSel); fill(toSel);
Â  }
Â  populateSelects();

Â  // Create clickable room markers using positions (% of image)
Â  function createMarkers(){
Â  Â  // Remove any existing
Â  Â  [...stage.querySelectorAll('.room-marker')].forEach(el => el.remove());
Â  Â  const rect = img.getBoundingClientRect();
Â  Â  const natW = img.naturalWidth, natH = img.naturalHeight;

Â  Â  rooms.forEach(r => {
Â  Â  Â  const marker = document.createElement('div');
Â  Â  Â  marker.className = 'room-marker';
Â  Â  Â  marker.dataset.room = r.name;
Â  Â  Â  marker.textContent = r.name;
Â  Â  Â  stage.appendChild(marker);
Â  Â  Â  // position in pixels (relative to natural size; will be transformed with stage)
Â  Â  Â  const x = natW * (r.xPct/100), y = natH * (r.yPct/100);
Â  Â  Â  marker.style.left = `${x}px`;
Â  Â  Â  marker.style.top Â = `${y}px`;

Â  Â  Â  marker.addEventListener('click', () => {
Â  Â  Â  Â  const mode = document.querySelector('input[name="selectMode"]:checked').value;
Â  Â  Â  Â  if (mode === 'from') {
Â  Â  Â  Â  Â  fromSel.value = r.name;
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  toSel.value = r.name;
Â  Â  Â  Â  }
Â  Â  Â  Â  highlightSelections();
Â  Â  Â  });
Â  Â  });
Â  Â  highlightSelections();
Â  }

Â  function highlightSelections(){
Â  Â  const from = fromSel.value, to = toSel.value;
Â  Â  [...stage.querySelectorAll('.room-marker')].forEach(m => {
Â  Â  Â  m.classList.remove('selected-from','selected-to');
Â  Â  Â  if (m.dataset.room === from) m.classList.add('selected-from');
Â  Â  Â  if (m.dataset.room === to) Â  m.classList.add('selected-to');
Â  Â  });
Â  }

Â  // Pan/Zoom handling
Â  let scale = 1, tx = 0, ty = 0, dragging = false, lastX = 0, lastY = 0;
Â  function applyTransform(){
Â  Â  stage.style.transform = `translate(${tx}px, ${ty}px) scale(${scale})`;
Â  }
Â  zoomInBtn.addEventListener('click', () => { scale = Math.min(3.0, scale*1.2); applyTransform(); });
Â  zoomOutBtn.addEventListener('click', () => { scale = Math.max(0.5, scale/1.2); applyTransform(); });
Â  zoomResetBtn.addEventListener('click', () => { scale=1; tx=0; ty=0; applyTransform(); });

Â  stage.addEventListener('mousedown', e => { dragging = true; lastX = e.clientX; lastY = e.clientY; stage.classList.add('grabbing'); });
Â  window.addEventListener('mouseup', () => { dragging = false; stage.classList.remove('grabbing'); });
Â  window.addEventListener('mousemove', e => {
Â  Â  if (!dragging) return;
Â  Â  const dx = e.clientX - lastX, dy = e.clientY - lastY;
Â  Â  tx += dx; ty += dy;
Â  Â  lastX = e.clientX; lastY = e.clientY;
Â  Â  applyTransform();
Â  });

Â  // Resize canvas to image natural size so coordinates align
Â  function resizeCanvasToImage(){
Â  Â  canvas.width Â = img.naturalWidth;
Â  Â  canvas.height = img.naturalHeight;
Â  }

Â  // Draw route as green dotted polyline
Â  function drawRoute(path){
Â  Â  resizeCanvasToImage();
Â  Â  ctx.clearRect(0,0,canvas.width,canvas.height);

Â  Â  // Convert to pixel points
Â  Â  const points = path.map(id => {
Â  Â  Â  const p = nodes[id];
Â  Â  Â  return { x: canvas.width*(p.xPct/100), y: canvas.height*(p.yPct/100) };
Â  Â  });

Â  Â  // Draw dotted line (green dots)
Â  Â  ctx.fillStyle = '#16a34a'; // green
Â  Â  ctx.strokeStyle = '#16a34a';
Â  Â  ctx.lineWidth = 2;

Â  Â  // draw small circles along each segment
Â  Â  const dotEveryPx = 16;
Â  Â  for (let i=1;i<points.length;i++){
Â  Â  Â  const a = points[i-1], b = points[i];
Â  Â  Â  const dx = b.x - a.x, dy = b.y - a.y;
Â  Â  Â  const len = Math.hypot(dx,dy);
Â  Â  Â  const steps = Math.max(1, Math.floor(len / dotEveryPx));
Â  Â  Â  for (let s=0;s<=steps;s++){
Â  Â  Â  Â  const t = s/steps;
Â  Â  Â  Â  const x = a.x + dx*t;
Â  Â  Â  Â  const y = a.y + dy*t;
Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  ctx.arc(x, y, 3.2, 0, Math.PI*2);
Â  Â  Â  Â  ctx.fill();
Â  Â  Â  }
Â  Â  }

Â  Â  // Start/end markers
Â  Â  if (points.length) {
Â  Â  Â  ctx.fillStyle = '#0078d4'; // Start: blue
Â  Â  Â  ctx.beginPath(); ctx.arc(points[0].x, points[0].y, 5, 0, Math.PI*2); ctx.fill();

Â  Â  Â  ctx.fillStyle = '#e81123'; // End: red
Â  Â  Â  const last = points[points.length-1];
Â  Â  Â  ctx.beginPath(); ctx.arc(last.x, last.y, 5, 0, Math.PI*2); ctx.fill();
Â  Â  }
Â  }

Â  // Show route handler
Â  function showRouteHandler(){
Â  Â  const from = fromSel.value, to = toSel.value;
Â  Â  stepsEN.innerHTML = ''; stepsDE.innerHTML = '';
Â  Â  if (!from || !to) {
Â  Â  Â  stepsEN.innerHTML = `<li>Please select both source and destination.</li>`;
Â  Â  Â  stepsDE.innerHTML = `<li>Bitte wÃ¤hle sowohl Start als auch Ziel aus.</li>`;
Â  Â  Â  ctx.clearRect(0,0,canvas.width,canvas.height);
Â  Â  Â  return;
Â  Â  }
Â  Â  if (from === to) {
Â  Â  Â  stepsEN.innerHTML = `<li>Source and destination are the same. You are already at ${from}.</li>`;
Â  Â  Â  stepsDE.innerHTML = `<li>Start und Ziel sind identisch. Du bist bereits bei ${from}.</li>`;
Â  Â  Â  ctx.clearRect(0,0,canvas.width,canvas.height);
Â  Â  Â  return;
Â  Â  }

Â  Â  const startId = `R:${from}`;
Â  Â  const endId Â  = `R:${to}`;
Â  Â  const path = shortestPath(startId, endId);

Â  Â  drawRoute(path);

Â  Â  const dirs = directionsForPath(path);
Â  Â  dirs.en.forEach(s => { const li = document.createElement('li'); li.textContent = s; stepsEN.appendChild(li); });
Â  Â  dirs.de.forEach(s => { const li = document.createElement('li'); li.textContent = s; stepsDE.appendChild(li); });
Â  Â  highlightSelections();
Â  }

Â  showBtn.addEventListener('click', showRouteHandler);

Â  // Speech synthesis
Â  function speakText(text, lang){
Â  Â  const utter = new SpeechSynthesisUtterance(text);
Â  Â  utter.lang = lang;
Â  Â  // Try to pick a matching voice (if available)
Â  Â  const voices = window.speechSynthesis.getVoices();
Â  Â  const match = voices.find(v => v.lang.toLowerCase().startsWith(lang.toLowerCase()));
Â  Â  if (match) utter.voice = match;
Â  Â  window.speechSynthesis.cancel(); // stop any previous
Â  Â  window.speechSynthesis.speak(utter);
Â  }

Â  playEN.addEventListener('click', () => {
Â  Â  const text = [...stepsEN.querySelectorAll('li')].map(li => li.textContent).join('. ');
Â  Â  if (!text) return;
Â  Â  speakText(text, 'en-US');
Â  });
Â  playDE.addEventListener('click', () => {
Â  Â  const text = [...stepsDE.querySelectorAll('li')].map(li => li.textContent).join('. ');
Â  Â  if (!text) return;
Â  Â  speakText(text, 'de-DE');
Â  });

Â  // Hook up nav button to show this panel
Â  const navButtons = document.querySelectorAll('.nav[data-panel]');
Â  navButtons.forEach(btn => {
Â  Â  btn.addEventListener('click', () => {
Â  Â  Â  const target = btn.getAttribute('data-panel'); // "rooms"
Â  Â  Â  document.querySelectorAll('.panel').forEach(p => {
Â  Â  Â  Â  p.style.display = (p.id === `panel-${target}`) ? 'block' : 'none';
Â  Â  Â  });
Â  Â  Â  // When shown, ensure everything is sized/ready
Â  Â  Â  if (target === 'rooms') {
Â  Â  Â  Â  // Wait for image to load first time
Â  Â  Â  Â  if (img.complete) {
Â  Â  Â  Â  Â  resizeCanvasToImage();
Â  Â  Â  Â  Â  createMarkers();
Â  Â  Â  Â  Â  applyTransform();
Â  Â  Â  Â  Â  // Deep link support e.g., ?from=Joy&to=Debug
Â  Â  Â  Â  Â  const params = new URLSearchParams(window.location.search);
Â  Â  Â  Â  Â  const fromP = params.get('from'), toP = params.get('to');
Â  Â  Â  Â  Â  if (fromP && rooms.find(r=>r.name===fromP)) fromSel.value = fromP;
Â  Â  Â  Â  Â  if (toP Â  && rooms.find(r=>r.name===toP)) Â  toSel.value Â  = toP;
Â  Â  Â  Â  Â  highlightSelections();
Â  Â  Â  Â  Â  if (fromSel.value && toSel.value) showRouteHandler();
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  img.addEventListener('load', () => {
Â  Â  Â  Â  Â  Â  resizeCanvasToImage();
Â  Â  Â  Â  Â  Â  createMarkers();
Â  Â  Â  Â  Â  Â  applyTransform();
Â  Â  Â  Â  Â  }, {once:true});
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  });
Â  });

Â  // If panel already visible on load, initialize once image is ready
Â  if (panel.style.display !== 'none') {
Â  Â  if (img.complete) { resizeCanvasToImage(); createMarkers(); applyTransform(); }
Â  Â  else { img.addEventListener('load', () => { resizeCanvasToImage(); createMarkers(); applyTransform(); }, {once:true}); }
Â  }

})();

Â  Â Â 

Â  /* ---------- QR FIX ---------- */
const LANDING_URL="https://techworks-pune.github.io/BMWTechWorks-VisitorInfo/";

async function downloadQR(){
const img=document.getElementById("siteQR");
const res=await fetch(img.src);
const blob=await res.blob();
const url=URL.createObjectURL(blob);
const a=document.createElement("a");
a.href=url;
a.download="BMWTechWorks_QR.png";
a.click();
URL.revokeObjectURL(url);
}

async function shareQR(){
if(navigator.share){
navigator.share({
title:"BMWTechWorks Pune",
url:LANDING_URL
});
}else{
navigator.clipboard.writeText(LANDING_URL);
alert("Link copied to clipboard");
}
}


Â  Â  Â  Â  Â 
Â  </script>

<script>
// --- Exit guidance (EN/DE) ---
(function(){
  const GUIDANCE = {
    en: {
      EXIT1: "From your current location, move west along the main corridor; at the junction turn north to reach the West Exit (near Success â€“ Board room).",
      EXIT2: "Head west and then south along the corridor to the Southâ€‘West Exit (near Joy).",
      EXIT3: "Proceed towards the central corridor and continue north to the Central Exit (near Debug).",
      EXIT4: "Go east along the main corridor; at the next junction turn north to reach the East Exit (near iDrive/Mâ€‘Mode).",
      EXIT5: "Continue east to the far right wing and turn south to reach the Farâ€‘East Exit (near Xdrive/Torque)."
    },
    de: {
      EXIT1: "Gehen Sie nach Westen entlang des Hauptflurs; biegen Sie an der Kreuzung nach Norden ab zum Westausgang (bei Success â€“ Boardroom).",
      EXIT2: "Gehen Sie nach Westen und dann nach SÃ¼den entlang des Flurs zum SÃ¼dwestausgang (bei Joy).",
      EXIT3: "Gehen Sie zum zentralen Flur und weiter nach Norden zum Zentralausgang (bei Debug).",
      EXIT4: "Gehen Sie nach Osten entlang des Hauptflurs; biegen Sie an der nÃ¤chsten Kreuzung nach Norden ab zum Ostausgang (bei iDrive/Mâ€‘Mode).",
      EXIT5: "Gehen Sie weiter nach Osten bis zum rechten FlÃ¼gel und biegen Sie nach SÃ¼den ab zum ganz rechten Ostausgang (bei Xdrive/Torque)."
    }
  };
  const exitSelect = document.getElementById('exitSelect');
  const langSelect = document.getElementById('langSelect');
  const routeText = document.getElementById('routeText');
  const playBtn = document.getElementById('play');
  const replayBtn = document.getElementById('replay');
  const muteBtn = document.getElementById('mute');

  function normalizeLang(v){ v = String(v||'en').trim().toLowerCase(); return v==='de'?'de':'en'; }
  function normalizeExit(v){ return String(v||'None').trim().toUpperCase(); }
  function defaultMessage(lang){ return lang==='de' ? 'WÃ¤hlen Sie einen Ausgang aus, um die Anleitung zu sehen.' : 'Select an exit to see guidance.'; }
  function guidanceText(exit, lang){ const L = GUIDANCE[lang]||GUIDANCE.en; return L[exit]||defaultMessage(lang); }

  let currentExit = normalizeExit(exitSelect?.value||'None');
  let currentLang = normalizeLang(langSelect?.value||'en');
  let isMuted = false;

  function updateUI(){
    routeText.textContent = guidanceText(currentExit, currentLang);
  }
  function speak(){
    if(currentExit==='NONE'){ updateUI(); return; }
    if(typeof window.speechSynthesis==='undefined'){ return; }
    try{ window.speechSynthesis.cancel(); }catch{}
    const utt = new SpeechSynthesisUtterance(guidanceText(currentExit, currentLang));
    utt.lang = currentLang==='de' ? 'de-DE' : 'en-US';
    utt.rate = 1.0; utt.pitch = 1.0; utt.volume = isMuted ? 0 : 1;
    window.speechSynthesis.speak(utt);
  }
  function replay(){ try{ window.speechSynthesis.cancel(); }catch{} speak(); }
  function toggleMute(){ isMuted = !isMuted; muteBtn.textContent = isMuted ? (currentLang==='de'?'Ton ein':'Unmute') : (currentLang==='de'?'Stumm':'Mute'); replay(); }

  exitSelect?.addEventListener('change', ()=>{ currentExit = normalizeExit(exitSelect.value); updateUI(); });
  langSelect?.addEventListener('change', ()=>{ currentLang = normalizeLang(langSelect.value); updateUI(); });
  playBtn?.addEventListener('click', speak);
  replayBtn?.addEventListener('click', replay);
  muteBtn?.addEventListener('click', toggleMute);

  updateUI();
})();
</script>

</body>
</html>
