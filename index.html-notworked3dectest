<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BTI Pune ‚Äì Visitor Info</title>
  <style>
    :root { --bg:#0b1f3b; --card:#112d58; --accent:#00d1b2; --text:#e8f0ff; --muted:#bcd2ff; }
    * { box-sizing: border-box; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background: var(--bg); color: var(--text); }
    header { padding: 20px 16px; text-align: center; background: linear-gradient(90deg, #0b1f3b 0%, #13325f 100%); border-bottom: 1px solid #1f3f74; }
    h1 { margin:0; font-size: 26px; }
    .container { max-width: 1200px; margin: 0 auto; padding: 16px; }
    .grid { display:grid; grid-template-columns: 1fr; gap:16px; }
    @media(min-width: 1024px){ .grid { grid-template-columns: 1.3fr 0.7fr; } }
    .card { background: var(--card); border:1px solid #1f3f74; border-radius:12px; overflow:hidden; }
    .card h2 { margin:0; padding:12px 16px; font-size:18px; border-bottom:1px solid #1f3f74; background: rgba(0,0,0,0.08); }
    .content { padding: 12px 16px; }
    .btn { display:inline-flex; align-items:center; gap:8px; border:1px solid #2e5baa; color:var(--text); background:#163b72; padding:10px 14px; border-radius:8px; cursor:pointer; text-decoration:none; }
    .btn:hover { filter: brightness(1.1); }
    .muted { color: var(--muted); font-size: 14px; }

    .zoom-wrap { position: relative; height: 62vh; min-height: 380px; background:#0a264e; border:1px solid #214a8a; border-radius:10px; overflow:hidden; }
    .zoom-inner { position:absolute; top:0; left:0; transform-origin:0 0; cursor: grab; }
    .zoom-inner.dragging { cursor:grabbing; }
    .zoom-hint { position:absolute; bottom:10px; right:12px; background:rgba(0,0,0,0.35); color:#e8f0ff; padding:6px 10px; border-radius:8px; font-size:12px; border:1px solid rgba(255,255,255,0.2); }

    .img-list { display:grid; grid-template-columns: 1fr; gap:12px; }
    @media(min-width:640px){ .img-list { grid-template-columns: 1fr 1fr; } }
    .img-item { background:#0a264e; border:1px solid #214a8a; border-radius:10px; padding:8px; }
    .img-item img { width:100%; border-radius:8px; }

    .tools { display:flex; gap:8px; flex-wrap:wrap; margin-top:12px; }
  </style>
</head>
<body>
  <header>
    <h1>BTI Pune ‚Äì Visitor Information</h1>
    <p class="muted">Zoomable exit plan ‚Ä¢ Tap-to-play audio guidance ‚Ä¢ Quick references ‚Ä¢ Share via QR</p>
  </header>

  <div class="container">
    <div class="grid">
      <section class="card">
        <h2>Exit Plan (Zoom ‚Ä¢ Pan ‚Ä¢ Fullscreen)</h2>
        <div class="content">
          <div class="zoom-wrap" id="zoomWrap">
            <img id="zoomImg" class="zoom-inner" src="r1.png" alt="BTI Pune Exit Plan" />
            <div class="zoom-hint">Scroll/pinch to zoom ‚Ä¢ Drag to pan ‚Ä¢ Double-tap to reset</div>
          </div>

          <div class="tools">
            <button class="btn" id="btnSpeak">üîä Play Audio Guidance</button>
            <button class="btn" id="btnStop">‚èπ Stop</button>
            <button class="btn" id="btnReset">‚Ü∫ Reset View</button>
            <button class="btn" id="btnZoomIn">‚ûï Zoom In</button>
            <button class="btn" id="btnZoomOut">‚ûñ Zoom Out</button>
            <button class="btn" id="btnFullscreen">‚õ∂ Fullscreen</button>
          </div>
          <p class="muted" style="margin-top:8px">Best experienced on Chrome/Edge. Use headphones in open areas.</p>
        </div>
      </section>

      <aside class="card">
        <h2>Quick References & QR</h2>
        <div class="content">
          <div class="img-list">
            <div class="img-item">
              <img src="r5.png" alt="Lanyard Types" />
              <p class="muted">ID lanyards: Employee ‚Ä¢ Contractor ‚Ä¢ Visitor ‚Ä¢ BMW Employee</p>
            </div>
            <div class="img-item">
              <img src="r2.png" alt="Access Zones" />
              <p class="muted">Access policy map: A‚ÄìG zones with restrictions and photography notes.</p>
            </div>
            <div class="img-item">
              <img src="r3.png" alt="Rooms & Areas" />
              <p class="muted">Key rooms: Success, Inspire, Joy, Debug, iDrive, M‚ÄëMode, Drift, xDrive, Torque.</p>
            </div>
          </div>

          <hr style="margin:16px 0; border-color:#1f3f74"/>

          <p><strong>Share via QR:</strong></p>
          <img src="updated_qr.png" alt="QR to site" style="max-width:240px; border:1px solid #214a8a; border-radius:8px; background:#0a264e; padding:8px"/>
          <div class="tools">
            <a class="btn" id="btnDownloadQR" download="BTI_Pune_QR.png" href="updated_qr.png">‚¨áÔ∏è Download QR</a>
            <button class="btn" id="btnPrint">üñ®Ô∏è Print Page</button>
          </div>
          <p class="muted">URL: <a href="https://bmwtechworks-pune.github.io/BMWTechWorks-VisitorInfo-December/" target="_blank">Open site</a></p>
        </div>
      </aside>
    </div>
  </div>

  <footer style="text-align:center; padding:18px; color:var(--muted)">
    ¬© BTI Pune ‚Äî Visitor Info. Refresh after updates.
  </footer>

  <script>
    // Zoom & Pan
    (function(){
      const wrap = document.getElementById('zoomWrap');
      const img = document.getElementById('zoomImg');
      let scale = 1, min=1, max=6; let ox=0, oy=0; let down=false, sx=0, sy=0;
      function apply(){ img.style.transform = `translate(${ox}px, ${oy}px) scale(${scale})`; }
      function clamp(){ const bw=wrap.clientWidth, bh=wrap.clientHeight; const iw=img.naturalWidth, ih=img.naturalHeight; const vw=iw*scale, vh=ih*scale; const minX=Math.min(0,bw-vw), minY=Math.min(0,bh-vh); ox=Math.max(minX, Math.min(ox, 0)); oy=Math.max(minY, Math.min(oy, 0)); }
      wrap.addEventListener('wheel', (e)=>{ e.preventDefault(); const rect=wrap.getBoundingClientRect(); const mx=e.clientX-rect.left, my=e.clientY-rect.top; const prev=scale; scale=Math.min(max,Math.max(min, scale*(e.deltaY<0?1.1:0.9))); ox=mx-(mx-ox)*(scale/prev); oy=my-(my-oy)*(scale/prev); clamp(); apply(); }, {passive:false});
      wrap.addEventListener('mousedown', (e)=>{ down=true; sx=e.clientX-ox; sy=e.clientY-oy; img.classList.add('dragging'); });
      window.addEventListener('mouseup', ()=>{ down=false; img.classList.remove('dragging'); });
      window.addEventListener('mousemove', (e)=>{ if(!down) return; ox=e.clientX-sx; oy=e.clientY-sy; clamp(); apply(); });
      // Touch
      let lastX=0,lastY=0, pinchStartDist=0,pinchStartScale=1;
      wrap.addEventListener('touchstart',(e)=>{ if(e.touches.length===2){ const dx=e.touches[0].clientX-e.touches[1].clientX; const dy=e.touches[0].clientY-e.touches[1].clientY; pinchStartDist=Math.hypot(dx,dy); pinchStartScale=scale; } else if(e.touches.length===1){ lastX=e.touches[0].clientX; lastY=e.touches[0].clientY; } },{passive:true});
      wrap.addEventListener('touchmove',(e)=>{ if(e.touches.length===2){ const dx=e.touches[0].clientX-e.touches[1].clientX; const dy=e.touches[0].clientY-e.touches[1].clientY; const dist=Math.hypot(dx,dy); scale=Math.min(max,Math.max(min,pinchStartScale*(dist/pinchStartDist))); apply(); } else if(e.touches.length===1){ const nx=e.touches[0].clientX, ny=e.touches[0].clientY; ox+=(nx-lastX); oy+=(ny-lastY); lastX=nx; lastY=ny; clamp(); apply(); } },{passive:true});
      // Reset & buttons
      document.getElementById('btnReset').addEventListener('click',()=>{ scale=1; ox=0; oy=0; apply(); });
      document.getElementById('btnZoomIn').addEventListener('click',()=>{ scale=Math.min(max, scale*1.2); apply(); });
      document.getElementById('btnZoomOut').addEventListener('click',()=>{ scale=Math.max(min, scale/1.2); apply(); });
      document.getElementById('btnFullscreen').addEventListener('click',()=>{ if(wrap.requestFullscreen) wrap.requestFullscreen(); });
      img.addEventListener('load', ()=>{ scale=1; ox=0; oy=0; apply(); });
      // Double-tap
      let lastTap=0; wrap.addEventListener('click',()=>{ const now=Date.now(); if(now-lastTap<350){ scale=1; ox=0; oy=0; apply(); } lastTap=now; });
    })();

    // Audio guidance
    (function(){
      const speechText = [
        'Welcome to BTI Pune. Follow the green arrows on the map to the nearest emergency exit.',
        'From your current location, move towards the main corridor and look for EXIT signs 1 through 5.',
        'Use staircases only. Do not use elevators during evacuation.',
        'Exit the building and assemble at the muster point near the main gate.',
        'Security and fire wardens will assist you. Stay calm and wait for the all‚Äëclear.'
      ].join('
');
      let u=null; const speakBtn=document.getElementById('btnSpeak'); const stopBtn=document.getElementById('btnStop');
      function speak(){ if(!('speechSynthesis' in window)){ alert('Speech Synthesis not supported in this browser.'); return; } window.speechSynthesis.cancel(); u=new SpeechSynthesisUtterance(speechText); u.rate=1; u.pitch=1; const voices=window.speechSynthesis.getVoices(); const prefer=voices.find(v=>/en-IN/i.test(v.lang))||voices.find(v=>/en/i.test(v.lang)); if(prefer) u.voice=prefer; window.speechSynthesis.speak(u); }
      speakBtn.addEventListener('click', speak); stopBtn.addEventListener('click', ()=>window.speechSynthesis.cancel());
      window.speechSynthesis.onvoiceschanged = function(){};
    })();

    // Print helper
    document.getElementById('btnPrint').addEventListener('click', ()=>{ window.print(); });
  </script>
</body>
</html>
